var k=Object.defineProperty;var v=(a,e,s)=>e in a?k(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var t=(a,e,s)=>(v(a,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))h(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&h(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function h(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();class d{constructor(e,s,h,i){t(this,"game");t(this,"image");t(this,"speedModifier");t(this,"width",1800*.8);t(this,"height",600*.8);t(this,"x",0);t(this,"y",0);t(this,"alpha");this.game=e,this.image=s,this.speedModifier=h,this.alpha=i}update(){this.x<=-this.width&&(this.x=0),this.x-=this.game.speed*this.speedModifier}draw(e){e.save(),e.globalAlpha=this.alpha,e.drawImage(this.image,this.x,this.y,this.width,this.height),e.drawImage(this.image,this.x+this.width,this.y,this.width,this.height),e.restore()}reset(){this.x=0}}class E{constructor(e){t(this,"game");t(this,"layers");this.game=e;let s=document.getElementById("layer1"),h=document.getElementById("layer2"),i=document.getElementById("layer3");this.layers=[new d(this.game,s,.2,.4),new d(this.game,h,.8,.6),new d(this.game,i,2.5,1)]}update(){this.layers.forEach(e=>e.update())}draw(e){this.layers.forEach(s=>s.draw(e))}reset(){this.layers.forEach(e=>e.reset())}}class y{constructor(e){t(this,"game");t(this,"width",10);t(this,"height",10);t(this,"x");t(this,"y");t(this,"markedForDeletion",!1);t(this,"speedX",-2);t(this,"color","red");t(this,"lives",1);t(this,"score",100);this.game=e,this.x=this.game.width,this.y=200}update(){this.x+=this.speedX,this.x+this.width<0&&(this.markedForDeletion=!0)}draw(e){e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height)}}class S extends y{constructor(s){super(s);t(this,"sheet");t(this,"staggerFrames",2);t(this,"sheetOffsetX",0);this.width=60/1.2,this.height=60/1.2,this.y=Math.random()*(this.game.height*.8-this.height),this.sheet=document.getElementById("garun")}draw(s){s.drawImage(this.sheet,60*this.sheetOffsetX,0,60,60,this.x,this.y,this.width,this.height)}update(){super.update(),this.animateSprite()}animateSprite(){this.staggerFrames--,this.staggerFrames<0&&(this.staggerFrames=2,this.sheetOffsetX=(this.sheetOffsetX+1)%8)}}class O extends y{constructor(s){super(s);t(this,"sheet");t(this,"staggerFrames",2);t(this,"sheetOffsetX",0);this.width=48/1.2,this.height=48/1.2,this.y=Math.random()*(this.game.height*.8-this.height),this.sheet=document.getElementById("flipper")}draw(s){s.save(),s.shadowColor="#E8E0987F",s.shadowBlur=15,s.filter="sepia(0.9) hue-rotate(-15deg) saturate(5)",s.drawImage(this.sheet,48*this.sheetOffsetX,0,48,48,this.x,this.y,this.width,this.height),s.restore()}update(){super.update(),this.animateSprite()}animateSprite(){this.staggerFrames--,this.staggerFrames<0&&(this.staggerFrames=2,this.sheetOffsetX=(this.sheetOffsetX+1)%6)}}class n{constructor(e,s,h){t(this,"game");t(this,"sheet");t(this,"x");t(this,"y");t(this,"width",60/1.2);t(this,"height",60/1.2);t(this,"markedForDeletion",!1);t(this,"sheetOffsetX",0);t(this,"staggerFrames",2);t(this,"maxFrames",5);this.game=e,this.sheet=document.getElementById("enemyExplosion"),this.x=s,this.y=h}update(){this.staggerFrames--,this.staggerFrames<0&&(this.staggerFrames=2,this.sheetOffsetX++),this.sheetOffsetX>=this.maxFrames&&(this.markedForDeletion=!0)}draw(e){e.drawImage(this.sheet,this.sheetOffsetX*60,0,this.width,this.height,this.x,this.y,this.width,this.height)}}class X extends n{constructor(s,h,i){super(s,h,i);t(this,"maxFrames",4);this.width=128/1.2,this.height=60/1.2,this.sheet=document.getElementById("playerExplosion")}update(){this.staggerFrames--,this.staggerFrames<0&&(this.staggerFrames=2,this.sheetOffsetX++),this.sheetOffsetX>=this.maxFrames&&(this.markedForDeletion=!0)}draw(s){s.drawImage(this.sheet,this.sheetOffsetX*128,0,this.width,this.height,this.x,this.y,this.width,this.height)}}class I{constructor(e){t(this,"game");this.game=e,window.addEventListener("keydown",s=>{switch(s.key){case"ArrowUp":this.game.keys.up=!0;break;case"ArrowDown":this.game.keys.down=!0;break;case"ArrowLeft":this.game.keys.left=!0;break;case"ArrowRight":this.game.keys.right=!0;break;case"z":this.game.keys.shoot=!0;break}}),window.addEventListener("keyup",s=>{switch(s.key){case"ArrowUp":this.game.keys.up=!1;break;case"ArrowDown":this.game.keys.down=!1;break;case"ArrowLeft":this.game.keys.left=!1;break;case"ArrowRight":this.game.keys.right=!1;break;case"z":this.game.keys.shoot=!1;break}})}}class F{constructor(e,s,h){t(this,"game");t(this,"width",27/1.2);t(this,"height",6/1.2);t(this,"x");t(this,"y");t(this,"speed",15);t(this,"markedForDelete",!1);t(this,"sheet");t(this,"sheetOffsetX",0);t(this,"staggerFrames",2);this.game=e,this.x=s-this.speed,this.y=h,this.sheet=document.getElementById("projectile")}update(){this.animateSprite(),this.x+=this.speed,this.x>this.game.width&&(this.markedForDelete=!0)}draw(e){e.drawImage(this.sheet,27*this.sheetOffsetX,0,27,6,this.x,this.y,this.width,this.height)}animateSprite(){this.staggerFrames--,this.staggerFrames<0&&(this.staggerFrames=2,this.sheetOffsetX=this.sheetOffsetX?0:1)}}const o=class o{constructor(e,s,h){t(this,"game");t(this,"player");t(this,"x");t(this,"y");t(this,"offset");t(this,"width",40);t(this,"height",30);t(this,"projectiles",[]);t(this,"lastShotTime",0);t(this,"shootCooldown",100);t(this,"sheet");var i,r;this.game=e,this.player=s,this.offset=h,this.x=(i=this.player.previousPositions[(h+1)*10])==null?void 0:i.x,this.y=(r=this.player.previousPositions[(h+1)*10])==null?void 0:r.y,this.sheet=document.getElementById("option"),o.instanceCount++}update(){var e,s;this.x=(e=this.player.previousPositions[(this.offset+1)*25])==null?void 0:e.x,this.y=(s=this.player.previousPositions[(this.offset+1)*25])==null?void 0:s.y}draw(e){e.fillStyle="white",e.drawImage(this.sheet,o.sheetOffsetX*48,0,48,36,this.x,this.y,this.width,this.height),this.projectiles.forEach(s=>s.draw(e))}animateSprite(){o.staggerFrames--,o.staggerFrames<0&&(o.staggerFrames=10,o.sheetOffsetX=(o.sheetOffsetX+1)%o.maxFrames)}shoot(){const e=Date.now();e-this.lastShotTime>this.shootCooldown&&(this.projectiles.push(new F(this.game,this.x+this.width,this.y+this.height/2)),this.lastShotTime=e)}};t(o,"instanceCount",0),t(o,"sheetOffsetX",0),t(o,"maxFrames",4),t(o,"staggerFrames",10);let c=o;class D{constructor(e){t(this,"game");t(this,"width");t(this,"height");t(this,"x");t(this,"y");t(this,"speedX",0);t(this,"speedY",0);t(this,"maxSpeed",3);t(this,"lives",3);t(this,"projectiles",[]);t(this,"lastShotTime",0);t(this,"shootCooldown",100);t(this,"previousPositions",[]);t(this,"options",[]);t(this,"sheet");t(this,"sheetOffsetX",2);t(this,"staggerFrames",2);this.game=e,this.x=20,this.y=this.game.height*.8/2,this.width=90/1.2,this.height=48/1.2,this.sheet=document.getElementById("vicViper")}update(){const e=Math.sin(Math.PI/4);this.speedX=0,this.speedY=0,this.game.keys.up?(this.rollUp(),this.speedY=-this.maxSpeed*(this.game.keys.left||this.game.keys.right?e:1)):this.game.keys.down?(this.rollDown(),this.speedY=this.maxSpeed*(this.game.keys.left||this.game.keys.right?e:1)):this.rollToIdle(),this.game.keys.right&&!this.game.keys.left?this.speedX=this.maxSpeed:this.game.keys.left&&!this.game.keys.right&&(this.speedX=-this.maxSpeed),this.x=this.x+this.speedX,this.x=Math.max(12,Math.min(this.x,this.game.width-this.width-12)),this.y=this.y+this.speedY,this.y=Math.max(12,Math.min(this.y,this.game.height*.8-this.height-12)),this.isLastPositionChanged()&&(this.previousPositions=this.previousPositions.slice(0,100),this.previousPositions.unshift({x:this.x,y:this.y}),this.options.length&&this.options.forEach(s=>s.update())),this.options.length&&this.options.forEach(s=>s.animateSprite()),this.game.keys.shoot&&(this.options.length&&this.options.forEach(s=>s.shoot()),this.shoot()),this.options.forEach(s=>{s.projectiles.forEach(h=>h.update()),s.projectiles=s.projectiles.filter(h=>!h.markedForDelete)}),this.projectiles.forEach(s=>s.update()),this.projectiles=this.projectiles.filter(s=>!s.markedForDelete)}draw(e){this.game.isMoving&&(this.options.length&&this.options.forEach(s=>s.draw(e)),e.drawImage(this.sheet,90*this.sheetOffsetX,0,90,48,this.x,this.y,this.width,this.height)),this.projectiles.forEach(s=>s.draw(e))}shoot(){const e=Date.now();e-this.lastShotTime>this.shootCooldown&&(this.projectiles.push(new F(this.game,this.x+this.width,this.y+this.height/2)),this.lastShotTime=e)}reset(){this.x=20,this.y=this.game.height*.8/2,this.previousPositions=[],this.options=[]}rollUp(){this.sheetOffsetX>0&&(this.staggerFrames--,this.staggerFrames<0&&(this.staggerFrames=2,this.sheetOffsetX--))}rollDown(){this.sheetOffsetX<4&&(this.staggerFrames--,this.staggerFrames<0&&(this.staggerFrames=2,this.sheetOffsetX++))}rollToIdle(){let e=2>this.sheetOffsetX;this.sheetOffsetX!==2&&(this.staggerFrames--,this.staggerFrames<0&&(this.staggerFrames=2,this.sheetOffsetX+=e?1:-1))}addOption(){this.options.push(new c(this.game,this,this.options.length))}isLastPositionChanged(){if(!this.previousPositions[0])return!0;const{x:e,y:s}=this.previousPositions[0];return e!==this.x||s!==this.y}}class P{constructor(e){t(this,"digitSheet");t(this,"letterSheet");t(this,"livesSprite");t(this,"game");t(this,"fontSize",25);t(this,"fontFamily","Press Start 2P");t(this,"color","white");t(this,"characterWidth",32);t(this,"characterHeight",32);this.game=e,this.digitSheet=document.getElementById("fontDigits"),this.letterSheet=document.getElementById("fontLetters"),this.livesSprite=document.getElementById("lives")}draw(e){this.renderScore(e),this.renderPlayerLives(e)}renderPlayerLives(e){e.font=`${this.fontSize}px '${this.fontFamily}'`,e.fillStyle=this.color,e.save(),e.imageSmoothingEnabled=!1,e.drawImage(this.livesSprite,0,0,32,32,30,556,32,32),e.restore(),this.drawDigit(e,this.game.player.lives,80,588-this.characterHeight)}renderScore(e){const s=String(this.game.score).padStart(7,"0"),h=250,i=588;if(!this.game.gameOver){for(let r=0;r<s.length;r++){const l=parseInt(s[r],10);this.drawDigit(e,l,h+r*this.characterWidth,i-this.characterHeight)}return}"GAME OVER".split("").forEach((r,l)=>this.drawCharacter(e,r.charCodeAt(0),h+l*this.characterWidth,i-this.characterHeight))}drawDigit(e,s,h,i){e.drawImage(this.digitSheet,s*(this.characterWidth+2),0,this.characterWidth+2,this.characterHeight,h,i,this.characterWidth+2,this.characterHeight)}drawCharacter(e,s,h,i){e.drawImage(this.letterSheet,(s-65)*(this.characterWidth+2),0,this.characterWidth+2,this.characterHeight,h,i,this.characterWidth+2,this.characterHeight)}}class b{constructor(e,s){t(this,"width");t(this,"height");t(this,"ui");t(this,"score",0);t(this,"player");t(this,"input");t(this,"keys",{up:!1,down:!1,left:!1,right:!1,shoot:!1});t(this,"enemies",[]);t(this,"enemyTimer",0);t(this,"enemyInterval",100);t(this,"explosions",[]);t(this,"gameOver",!1);t(this,"isMoving",!0);t(this,"timeoutSignal",0);t(this,"speed",1);t(this,"bg");this.width=e,this.height=s,this.player=new D(this),this.input=new I(this),this.ui=new P(this),this.bg=new E(this)}update(){this.isMoving?(this.bg.update(),this.player.update(),this.enemies.forEach(e=>{e.update(),this.checkCollision(this.player,e)&&(this.player.lives=Math.max(this.player.lives-1,0),this.player.lives===0&&(this.gameOver=!0),this.isMoving=!1,this.explosions.push(new X(this,this.player.x-15,this.player.y-4)),e.markedForDeletion=!0,this.explosions.push(new n(this,e.x,e.y))),this.player.projectiles.forEach(s=>{this.checkCollision(s,e)&&(e.lives--,s.markedForDelete=!0,e.lives<=0&&(this.score+=e.score,e.markedForDeletion=!0,this.explosions.push(new n(this,e.x,e.y))))}),this.player.options.length&&this.player.options.forEach(s=>s.projectiles.forEach(h=>{this.checkCollision(h,e)&&(e.lives--,h.markedForDelete=!0,e.lives<=0&&(this.score+=e.score,e.markedForDeletion=!0,this.explosions.push(new n(this,e.x,e.y))))}))}),this.enemies=this.enemies.filter(e=>!e.markedForDeletion),this.enemyTimer>this.enemyInterval&&!this.gameOver?(this.addEnemy(),this.enemyTimer=0):this.enemyTimer++):!this.timeoutSignal&&!this.gameOver&&(this.timeoutSignal=setTimeout(()=>{this.bg.reset(),this.player.reset(),this.enemies=[],this.player.projectiles=[],this.explosions=[],this.timeoutSignal=0,this.isMoving=!0},3e3)),this.explosions.filter(e=>!e.markedForDeletion),this.explosions.forEach(e=>e.update())}draw(e){this.bg.draw(e),this.player.draw(e),this.ui.draw(e),this.enemies.forEach(s=>{s.draw(e)}),this.explosions.forEach(s=>{s.draw(e)})}addEnemy(){this.enemies.push(new S(this),new O(this))}checkCollision(e,s){return e.x<s.x+s.width&&e.x+e.width>s.x&&e.y<s.y+s.height&&e.y+e.height>s.y}}const g=document.getElementById("canvas"),p=g.getContext("2d");g.width=800;g.height=600;const u=new b(g.width,g.height),M=45;let w,m,f=Date.now();function x(){requestAnimationFrame(x),m=Date.now(),w=m-f,w>1e3/M&&(m=f,f=Date.now(),p.clearRect(0,0,g.width,g.height),u.update(),u.draw(p))}x();
